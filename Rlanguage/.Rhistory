1+1
source("~/Visual Studio 2017/Projects/Rlanguage/Rlanguage/script.R", encoding = "big5")
x <- c(4.39, 2.11, 3.17)
x
class(x)
x[2]
x[2:1]
x[3:2]
x[3:1]
y <- c("apple", "book", "cat")
y
class[y]
class[y]
class(y)
xx <- c("three", 3, 2, 1)
xx
class(xx)
class(zz)
zz <- c(1, 2, "three")
class(zz)
y1 <- c(A = "apple", B = "book", C = "cat")
y1
name(y1)
name(y1)
y1
names(y1)
order(x)
x
x[order(x)]
y <- c("apple", "book", "cat")
y[c(-1:2)]
y[c(-1,-2)]
x>3
which(x>3)
x[which(x>3)]
y
y[c(-1:-2)]
y[c(-1,-3)]
rm
rm(x)
rm(y)
rm(y1)
x <- c(4.39, 2.11, 3.17)
y <- c("apple", "book", "cat")
z <- c(TRUE, FALSE, TRUE)
df <- data.frame(v1 = x, v2 = y, v3 = z)
df
df[2,]
df[,3]
df[2,3]
df["v1",]
df['v1',]
df[,"v1"]
str(df)
df$v2
df[1]
df[c("v2","v3")]
df[df$v1>3 & z==TRUE,"v2"]
df
df[df$v1>3 & z==TRUE,"v2"]
df[df$v1 > 3 & z == TRUE]
df$v2
df$v1
df[df$v1 > 3 & z == TRUE]
df[df$v1 > 3 & z == TRUE,]
df[df$v1>3 & z==TRUE,"v2"]
df[df$v1>3 && z==TRUE,"v2"]
df[which(df$v1>3 & z==TRUE),"v2"]
ubike <- read.csv(file = "./ubike-weather-big5.csv",           colClasses = c("factor", "integer", "integer", "factor", "factor",                          "numeric", "numeric", "integer", "numeric", "integer",                          "integer", "numeric", "numeric", "integer", "integer",                          "numeric", "numeric", "numeric", "numeric", "numeric",                          "numeric", "numeric", "numeric"),           fileEncoding = 'BIG-5',           stringsAsFactors = F)
ubike
View(ubike)
View(ubike)
rm(x, envir = as.environment(".GlobalEnv"))
cls
install.packages('dplyr')
library(dplyr)
install.packages("dplyr", lib="C:/Program Files/Microsoft/R Client/R_SERVER/library")
library(dplyr)
install.packages("dplyr", lib="C:/Program Files/Microsoft/R Client/R_SERVER/library")
library(dplyr)
          stringsAsFactors = F)
ubike <- read.csv(file = "./ubike-weather-big5.csv",           colClasses = c("factor", "integer", "integer", "factor", "factor",                          "numeric", "numeric", "integer", "numeric", "integer",                          "integer", "numeric", "numeric", "integer", "integer",                          "numeric", "numeric", "numeric", "numeric", "numeric",                          "numeric", "numeric", "numeric"),           fileEncoding = 'BIG-5',           stringsAsFactors = F)
head(ubike)
ubike$date<-as.Date(ubike$date)
select(ubike, hour, sarea, sna, avg.sbi) %>%   filter(sarea == '中和區' & hour == 7) %>%   mutate(avg.sbi = floor(avg.sbi))
select(ubike, hour, sarea, sna, avg.sbi) %>%   filter(sarea == '中和區' & hour == 7) %>%   group_by(hour, sarea, sna) %>%   summarise(avg = mean(avg.sbi) %>% round()) %>%   arrange(avg %>% desc())
install.packages("rmarkdown", lib="C:/Users/Stone.lee/Documents/R/win-library/3.3")
ubike <- read.csv(file = "./ubike-weather-big5.csv",           colClasses = c("factor", "integer", "integer", "factor", "factor",                          "numeric", "numeric", "integer", "numeric", "integer",                          "integer", "numeric", "numeric", "integer", "integer",                          "numeric", "numeric", "numeric", "numeric", "numeric",                          "numeric", "numeric", "numeric"),           fileEncoding = 'BIG-5',           stringsAsFactors = F) View(ubike) ubike$date<-as.Date(ubike$date) library(dplyr)
select(ubike, sarea, sna, ifelse(rainfall == "NA" | rainfall == 0, "晴天", "雨天")) %>% filter(sarea == "信義區") %>% group_by(sna) select()
select(ubike, sarea, sna, ifelse(rainfall == "NA" | rainfall == 0, "晴天", "雨天")) %>% filter(sarea == "信義區") %>% group_by(sna)
select(ubike, sarea, sna) %>% filter(sarea == "信義區") %>% group_by(sna)
select(ubike, sarea, sna,rainfall) %>% filter(sarea == "信義區") %>% group_by(sna)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx=ifelse(rainfall=="NA"|rainfall==0,"sun","rain")) group_by(sna) %>% select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(sna) %>% select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(sna)
select(ubike, sarea, sna) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(sna)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(sna)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(sna) %>% select(sarea,sna,xx)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(sna) %>% tt<-select(sarea,sna,xx)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(sna) %>% select(sarea,sna,xx)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(xx = ifelse(rainfall == "NA" | rainfall == 0, "sun", "rain")) %>% group_by(xx) %>% summarise(sv = sum(xx))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall >1, 1, 0)) 
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% group_by(sarea) %>% summarise(sv1 = sum(晴天), sv2 = sum(雨天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% group_by(sarea)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea) %>% select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea) 
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% summarise(group_by(sarea),d= sum(晴天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% summarise(group_by(sarea),d= sum(晴天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% summarise(group_by(sarea),d= sum(晴天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% summarise(d= sum(晴天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select( group_by( sarea), sum( 晴天), sum(雨天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea) %>% summarise(sum(晴天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% summarise_each(funs = sum)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% aggregate(sarea,by=list(sarea),funs=sum)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% aggregate(sarea,by=list(sarea),FUN=sum)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea) %>% summarise(zzz=sum(晴天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% xxxx=select(sarea, 晴天, 雨天) 
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% xxxx<=select(sarea, 晴天, 雨天) 
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% xxx<-select(sarea, 晴天, 雨天) 
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% xxx <- mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% xxx <- mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>%
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% str()
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% #str() class()
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% xxx<-data.frame
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% str()
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% sum(晴天)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea) %>% sum(晴天)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea) %>% summarise_each(funs(sum))
xxxx<-(select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea))
xxxx<-(select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天)) %>% xxxx<-(select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天))
xxxx<-(select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea))
sum(xxxx$`晴天`)
aggregate(xxxx$`晴天`,by=list(zzzz=xxxx$sarea),FUN=sum)
aggregate(xxxx$`晴天`,by=list(zzzz=xxxx$sarea),funs=sum)
str(xxxx)
View(xxxx)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall == "NA") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天)
xxxx1 <- (select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall == "NA") %>% mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea))
View(xxxx)
xxxx1 <- (select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall == "NA") %>% #mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea))
xxxx1 <- (select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall == "NA") %>% #mutate(晴天 = ifelse(rainfall == "NA" | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% #select(sarea, 晴天, 雨天) %>% group_by(sarea))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall == "NA")
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" )
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall %like% "%NA%")
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall == "NA")
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & rainfall > 0)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & is.na(rainfall))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區" & !is.na(rainfall))
rm(xxxx, envir = as.environment(".GlobalEnv"))
xxxx <- (select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 1, 1, 0)) %>% select(sarea, 晴天, 雨天) %>% group_by(sarea))
sum(xxxx$`晴天`)
count(xxxx)
count(xxxx)
sum(xxxx$`晴天`)/count(xxxx)
str(xxxx)
sum(xxxx$`晴天`)/count(xxxx)
sum(xxxx$`晴天`)/count(xxxx$sarea)
z<-sum(xxxx$`晴天`)/count(xxxx)
z
z$n
rm(xxxx, envir = as.environment(".GlobalEnv"))
xxxx <- (select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 0, 1, 0)) %>% select(sarea,sna, 晴天, 雨天) %>% group_by(sarea))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 0, 1, 0)) %>% select(sarea, sna, 晴天, 雨天) %>% group_by(sna)
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(rainfall > 0, 1, 0)) %>% select(sarea, sna, 晴天, 雨天) %>% group_by(sna) %>% summarise(sna,funs(sum))
sum(xxxx$`晴天`)
count(xxxx)
length(count(xxxx))
sum(xxxx$`雨天`)
sum(xxxx$`晴天`)
rm(xxxx, envir = as.environment(".GlobalEnv"))
xxxx <- (select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(!is.na(rainfall) & rainfall > 0, 1, 0)) %>% select(sarea, sna, 晴天, 雨天) %>% group_by(sarea) )
sum(xxxx$`雨天`)
sum(xxxx$`晴天`)
sun<-sum(xxxx$`晴天`)
rain <- sum(xxxx$`雨天`)
tatol <- sun + rain
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(!is.na(rainfall) & rainfall > 0, 1, 0)) %>% select(sarea, sna, 晴天, 雨天) %>% group_by(sarea) %>% summarise(dd = n(), ee = sum(晴天), ff = sum(雨天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(!is.na(rainfall) & rainfall > 0, 1, 0)) %>% select(sarea, sna, 晴天, 雨天) %>% group_by(sna) %>% summarise(dd = n(), ee = sum(晴天), ff = sum(雨天))
select(ubike, sarea, sna, rainfall) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(!is.na(rainfall) & rainfall > 0, 1, 0)) %>% select(sarea, sna, 晴天, 雨天) %>% group_by(sna) %>% summarise(zzz=n())
select(ubike, sarea, sna, rainfall, avg.bemp/tot) %>% filter(sarea == "信義區")
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(晴天 = ifelse(is.na(rainfall) | rainfall == 0, 1, 0), 雨天 = ifelse(!is.na(rainfall) & rainfall > 0, 1, 0), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 晴天, 雨天, 使用率)
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(天氣 = ifelse(is.na(rainfall) | rainfall == 0, 晴天, 雨天), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 天氣, 使用率) 
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(天氣 = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 天氣, 使用率) 
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(天氣 = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 天氣, 使用率) %>% group_by(sna, 天氣) %>% summarise(zzz = n())
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(天氣 = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 天氣, 使用率) %>% group_by(sna)
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(天氣 = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 天氣, 使用率) %>% group_by(sna, sarea) 
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(天氣 = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 天氣, 使用率) %>% group_by( sarea,"天氣") %>% summarise(zzz = n())
zzzz<-(select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(天氣 = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), 使用率 = avg.bemp / tot) %>% select(sarea, sna, 天氣, 使用率))
dcast.data.table(zzzz,天氣)
install.packages("reshape2", lib="C:/Users/Stone.lee/Documents/R/win-library/3.3")
library(reshape2)
dcast(zzzz, formula = sarea~天氣,使用率)
dcast(zzzz, formula = sarea ~ 天氣,使用率)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), 使用率 = avg.bemp / tot) %>% select(sarea, sna, day, 使用率))
dcast(zzzz, formula = sarea ~ day,使用率)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using))
dcast(zzzz, formula = sarea ~ day, using)
zzzz
head(zzzz)
dcast(zzzz, formula = sarea ~ day,value.var = ( "using"))
dcast(zzzz, formula = sna ~ day, value.var = ("using"))
dcast(zzzz, formula = sna ~ day, value.var = c("using"))
dcast(zzzz, formula = sna ~ day, fun.aggregate = c("using"), value.var = c("using"))
dcast(zzzz, formula = sna ~ day, fun.aggregate = using, value.var = c("using"))
dcast(zzzz, formula = sna ~ day, fun.aggregate = as.numeric, value.var = c("using"))
dcast(zzzz, formula = sna ~ day, fun.aggregate = as.logical , value.var = c("using"))
dcast(zzzz, formula = sna ~ day, fun.aggregate = as.logical , value.var = using))
dcast(zzzz, formula = sna ~ day, value.var = using))
dcast(zzzz, formula = sna ~ day, fun.aggregate = as.logical, value.var = using)
dcast(zzzz, formula = sna ~ day, fun.aggregate = as.logical, value.var = c("using"))
dcast(zzzz, formula = sna ~ day, fun.aggregate = mean, value.var = using)
dcast(zzzz, formula = sna ~ day, value.var = c("using"))
dcast(zzzz, formula = sna ~ day, value.var = using)
dcast(zzzz, formula = sna ~ day, fun.aggregate = mean, value.var = c("using"))
dcast(zzzz, formula = sna ~ day, fun.aggregate = mean)
ubike <- read.csv(file = "./ubike-weather-big5.csv",           colClasses = c("factor", "integer", "integer", "factor", "factor",                          "numeric", "numeric", "integer", "numeric", "integer",                          "integer", "numeric", "numeric", "integer", "integer",                          "numeric", "numeric", "numeric", "numeric", "numeric",                          "numeric", "numeric", "numeric"),           fileEncoding = 'BIG-5',           stringsAsFactors = F)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天")) %>% select(sarea, sna, day))
dcast(zzzz, formula = sna ~ day, fun.aggregate = mean)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using))
dcast(zzzz, formula = sna ~ day, fun.aggregate = mean)
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% str()
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using) str()
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% str()
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse( rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% str()
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse( rainfall == 0, 0, 1), using = avg.bemp / tot) %>% str()
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse( rainfall == 0, 0, 1), using = avg.bemp / tot) %>% class()
select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse( rainfall == 0, 0, 1), using = avg.bemp / tot) %>% class(day)
xxxx<-(select(ubike, sarea, sna, rainfall, avg.bemp, tot) %>% filter(sarea == "信義區") %>% mutate(day = ifelse( rainfall == 0, 0, 1), using = avg.bemp / tot))
library(magrittr)
library(data.table)
install.packages("ggmap", lib="C:/Users/Stone.lee/Documents/R/win-library/3.3")
library(ggmap)
ggmap(Map, darken = c(0.5, "white")) +   geom_point(aes(x = lon, y = lat, size = UVI), data = ubike)
ggmap(Map, darken = c(0.5, "white")) 
ggmap(ubike, darken = c(0.5, "white"))
map<-get_map(longley=ubike$lng,lattice=ubike$lat)
qmap("taiwan", zoom = 8)
geom_point(data = ubike$sarea, aes(y = ubike$lng, x = ubike$lat), color = "red", size = 3, alpha = 0.5) 
qmap("taiwan", zoom = 8, extent = "device", legend = "topleft", alpha = 0.5) +
  stat_density2d(
    aes(y = ubike$lng, x = ubike$lat),
    size = 2, bins = 15, data = ubike,
    geom = "polygon")
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "hybrid") ggmap(map)
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "toner-lite") ggmap(map)
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "terrain") ggmap(map)
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "satellite") ggmap(map)
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "roadmap") ggmap(map)
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "hybrid") ggmap(map)
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "roadmap") ggmap(map)
map = get_googlemap(center = c(lon = median(ubike$lng), lat = median(ubike$lat)) , zoom = 14, maptype = "terrain") ggmap(map)
install.packages("rvest", lib="C:/Users/Stone.lee/Documents/R/win-library/3.3")
x<-c(1:5)
for (item in x) {     print(item) }
for (item in 1:x) {     print(item) }
for (item in 1:length(x)) {     print(item) }
name <- function(parameters1 =1, parameters2=2) {     xx <- parameters1 * parameters1     return(xx) }
name()
name()
name <- function(parameters1 =1, parameters2=2) {     xx <- parameters1 * parameters2     return(xx) }
name()
name(4,6)
?plot
library(ggplot2)
?plot
library(dplyr)
dat<-iris
head(dat)
install.packages("plotly", lib="C:/Users/Stone.lee/Documents/R/win-library/3.3")
library(plotly)
head(dat)
dat %>% ggplot(ase(x = Sepal.Length, y = Petal.Length, color = Species)) + geom_point()
dat %>% ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) + geom_point()
ggplotly()
dat %>% ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) + geom_point() ggplotly()
dat %>% ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) + geom_point() ggplotly()
dat %>% ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) + geom_point() %>% ggplotly()
qq <-(dat %>% ggplot(aes(x = Sepal.Length, y = Petal.Length, color = Species)) + geom_point() ) ggplotly(qq)
library(plotly)
ggmap(map)
ggplot2(aes(x = ubike$lng,y = ubike$lat,color=ubike$sno))
library(ggplot2)
ggplot2(aes(x = ubike$lng,y = ubike$lat,color=ubike$sno))
ggplot(aes(x = ubike$lng,y = ubike$lat,color=ubike$sno))
ggplot(aes(x = ubike$lng,y = ubike$lat,color=ubike$sno))
ggplotly(aes(x = ubike$lng, y = ubike$lat, color = ubike$sno))
ggplot(aes(x = ubike$lng, y = ubike$lat, color = ubike$sno)) + geom_point()
geom_point()
head(ubike)
ubike <- read.csv(file = "./ubike-weather-big5.csv",           colClasses = c("factor", "integer", "integer", "factor", "factor",                          "numeric", "numeric", "integer", "numeric", "integer",                          "integer", "numeric", "numeric", "integer", "integer",                          "numeric", "numeric", "numeric", "numeric", "numeric",                          "numeric", "numeric", "numeric"),           fileEncoding = 'BIG-5',           stringsAsFactors = F)
head(ubike)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot,lat,lng) %>% #搜尋信義區 filter(sarea == "信義區") %>% #判斷是否雨天,降雨為0都為晴天 #但透過View看過資料後發現有NA的資料,加入判斷空值 #using為使用率=空車位/實際車位 mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>%
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot,lat,lng) %>% #搜尋信義區 filter(sarea == "信義區") %>% #判斷是否雨天,降雨為0都為晴天 #但透過View看過資料後發現有NA的資料,加入判斷空值 #using為使用率=空車位/實際車位 mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) )
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot,lat,lng) %>% #搜尋信義區 filter(sarea == "信義區") %>% #判斷是否雨天,降雨為0都為晴天 #但透過View看過資料後發現有NA的資料,加入判斷空值 #using為使用率=空車位/實際車位 mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% )
select(ubike, sarea, sna, rainfall, avg.bemp, tot,la) %>% #搜尋信義區 filter(sarea == "信義區") %>% #判斷是否雨天,降雨為0都為晴天 #但透過View看過資料後發現有NA的資料,加入判斷空值 #using為使用率=空車位/實際車位 mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot)
ubike %>% zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot,la) %>% #搜尋信義區 filter(sarea == "信義區") %>% #判斷是否雨天,降雨為0都為晴天 #但透過View看過資料後發現有NA的資料,加入判斷空值 #using為使用率=空車位/實際車位 mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% )
ubike %>% zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, la) %>% #搜尋信義區 filter(sarea == "信義區") %>% #判斷是否雨天,降雨為0都為晴天 #但透過View看過資料後發現有NA的資料,加入判斷空值 #using為使用率=空車位/實際車位 mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, la))
ubike %>% zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, la) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, la))
library(dplyr)
ubike %>% zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, la) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, la))
ubike <- read.csv(file = "./ubike-weather-big5.csv",           colClasses = c("factor", "integer", "integer", "factor", "factor",                          "numeric", "numeric", "integer", "numeric", "integer",                          "integer", "numeric", "numeric", "integer", "integer",                          "numeric", "numeric", "numeric", "numeric", "numeric",                          "numeric", "numeric", "numeric"),           fileEncoding = 'BIG-5',           stringsAsFactors = F)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, la) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, la))
ubike %>% zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat))
head(ubike)
ubike %>% zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng))
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng))
head(zzzz)
qq <- (zzzz %>% ggplot(aes(x = lat, y = lng, color = sna)) + geom_point())
library(ggmap) library(plotly) library(ggplot)
library(ggplot2)
qq <- (zzzz %>% ggplot(aes(x = lat, y = lng, color = sna)) + geom_point()) ggplotly(qq)
qq <- (zzzz %>% ggplot(aes(x = lat, y = lng, color = sna)) + geom_point())
zzzz %>% map <- get_map(location = 'Taiwan', zoom = 7) %>% ggmap(map) + geom_point(aes(x = zzzz$lng, y = zzzz$lat, size = UVI), data = uv) %>% ggplot(aes(x = lat, y = lng, color = sna)) + geom_point()
zzzz %>% map <- get_map(location = 'Taiwan', zoom = 7) %>% ggmap(map)  %>% ggplot(aes(x = lat, y = lng, color = sna)) + geom_point()
get_map(location = 'Taiwan', zoom = 7)
map <- get_map(markers = zzzz) %>% ggmap(map) 
map <- get_googlemap(markers = zzzz) %>% ggmap(map)
?get_googlemap
ggmap(get_googlemap())
ggplot(zzzz, aes(map_id = id)) +   geom_map(aes(fill = growth, color = category), map = world.ggmap) +   expand_limits(x = zzzz$lng, y = zzzz$lat) +   scale_fill_gradient(high = "red", low = "white", guide = "colorbar") +   scale_colour_hue(h = c(120, 240))
 fiji <- get_map("fiji", zoom = 4)
houston <- get_map("Houston", zoom = 11) p <- ggmap(houston) + geom_point(data = subset(crime, date == "1/2/2010"), aes(x = lon, y = lat, shape = offense)) ggsave("plot-map-houston-crime.png", p, width = 6, height = 4, dpi = 100)
houston <- get_map("Taipei")
head(zzzz)
ggmap(map) + thm() +   geom_point(data = zzzz, aes(x = lng, y = lat, size = using)) +   geom_text(data = zzzz, aes(x = lng, y = lat, label = sna),   position = "jitter", vjust = -1, hjust = 0.5, size = 4, family = "STHeiti") +   theme(legend.position = "none") +   scale_size(range = c(3, 12))
map <- get_map(location = c(lon = zzzz$lng, lat = zzzz$lat), zoom = 15)
? get_map
map <- get_map(location = c(lon = 25.032721, lat = 121.570555), zoom = 15)
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 15)
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 50)
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 10)
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 13)
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 14)
ggmap(map) + thm() +   geom_point(data = zzzz, aes(x = lng, y = lat, size = using)) +   geom_text(data = zzzz, aes(x = lng, y = lat, label = sna),   position = "jitter", vjust = -1, hjust = 0.5, size = 4, family = "STHeiti") +   theme(legend.position = "none") +   scale_size(range = c(3, 12))
ggmap(map) +    geom_point(data = zzzz, aes(x = lng, y = lat, size = using)) +   geom_text(data = zzzz, aes(x = lng, y = lat, label = sna),   position = "jitter", vjust = -1, hjust = 0.5, size = 4, family = "STHeiti") +   theme(legend.position = "none") +   scale_size(range = c(3, 12))
ggmap(map) +    geom_point(data = zzzz, aes(x = lng, y = lat, size = using)) 
ggmap(map) +    geom_point(data = zzzz, aes(x = lng, y = lat, color = using)) 
ggmap(map) +    geom_point(data = ubike, aes(x = lng, y = lat, color = using)) 
ggmap(map) +    geom_point(data = ubike, aes(x = lng, y = lat, color = sna)) 
ggmap(map) +    geom_point(data = zzzz, aes(x = lng, y = lat, color = using)) 
ggmap(map) +   geom_point(data = zzzz, aes(x = lng, y = lat, color = using,text=null))
ggmap(map) +   geom_point(data = zzzz, aes(x = lng, y = lat, color = using,text=""))
cc<-(ggmap(map) +   geom_point(data = zzzz, aes(x = lng, y = lat, color = using,text="")))
ggplotly(cc)
cc <- (ggmap(map) +   geom_point(data = zzzz, aes(x = lng, y = lat, color = using, style = 'feature:administrative.country|element:labels|visibility:off')))
ggmap(map) +   geom_point(data = zzzz, aes(x = lng, y = lat, color = using, style = 'feature:administrative.country|element:labels|visibility:off'))
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 14, style = 'feature:administrative.country|element:labels|visibility:off')
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 14,)
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 14, maptype = "toner-lite")
map <- get_map(location = c(lon = 121.570555, lat = 25.032721), zoom = 14, maptype = c("toner-lite"), source = "osm")
sun <- filter(zzzz, day == "晴天")
rain <- filter(zzzz, day == "雨天")
ubike <- read.csv(file = "./ubike-weather-big5.csv",           colClasses = c("factor", "integer", "integer", "factor", "factor",                          "numeric", "numeric", "integer", "numeric", "integer",                          "integer", "numeric", "numeric", "integer", "integer",                          "numeric", "numeric", "numeric", "numeric", "numeric",                          "numeric", "numeric", "numeric"),           fileEncoding = 'BIG-5',           stringsAsFactors = F)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng))
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% #搜尋信義區 filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng))
select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng)
zzzz <- (select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng))
library(ggmap) library(plotly) library(ggplot2)
zzzz <- ( select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% filter(sarea == "信義區") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng))
zzzz2 <- ( select(ubike, sarea, sna, rainfall, avg.bemp, tot, lat, lng) %>% filter(sarea == "信義區" & sna == "台北市政府") %>% mutate(day = ifelse(is.na(rainfall) | rainfall == 0, "晴天", "雨天"), using = avg.bemp / tot) %>% select(sarea, sna, day, using, tot, lat, lng))
display <- dcast(zzzz, formula = sna ~ day, fun.aggregate = mean, value.var = "using")
library(dplyr) library(reshape2)
display <- dcast(zzzz, formula = sna ~ day, fun.aggregate = mean, value.var = "using")
ggplot(display, aes(sna, fill = day)) + geom_bar(position = "dodge")
ggplot(zzzz, aes(sna, fill = day)) + geom_bar(position = "dodge")
ggplot(zzzz, aes(sna, fill = day),width=500) + geom_bar(position = "dodge")
```{r, fig.width=10, fig.height=8}
